"use strict";window.thoughtspot=function(){function t(t){var o=document.createElement("a");return o.href=t,{protocol:o.protocol,hostname:o.hostname,port:o.port,pathname:o.pathname,search:o.search,hash:o.hash,host:o.host}}function o(){var o=document.getElementsByTagName("script"),n=o[o.length-1],e=n.src;if(!e)return console.error("Could not determine Thoughtspot domain from script's url"),"";var r=t(e);return r.host}function n(t,o){return Object.keys(o).forEach(function(n){var e="\\{"+n+"\\}",r=RegExp(e,"g");t=t.replace(r,o[n])}),t}function e(t,o){return o=encodeURIComponent(o),t+=t.indexOf("#")>=0?o:"#"+o}function r(t,o){var e=document.location.protocol;return"/"!==o[0]&&(o="/"+o),n("{protocol}//{domain}{path}",{protocol:e,domain:t,path:o})}function a(t,o){var n=new XMLHttpRequest;n.withCredentials=!0,n.onreadystatechange=function(){if(!(4>n.readyState)){var t=200===n.status;o(t)}};var e=r(t,T.AUTH_VERIFICATION);n.open("GET",e,!0),n.send()}function i(t){var o=e(window.location.href,p),a=n(T.SSO_LOGIN_TEMPLATE,{targetUrl:encodeURIComponent(o)}),i=r(t,a);window.location.href=i}function c(){return window.location.href.indexOf(p)>=0}function u(){window.location.hash=window.location.hash.replace(p,"")}function s(t){window.addEventListener("message",function(o){var n=o.origin.replace(/^https?:\/\//,"");if(n===t)return o.data&&o.data.type===l.THOUGHTSPOT_AUTH_EXPIRED?(E&&m.forEach(function(t){t()}),void 0):(console.error("ThoughtSpot sent a postMessage with an unexpected event",o),void 0)})}function d(t){var o=m.indexOf(t)>=0;o||m.push(t)}function h(t,o,n){if(void 0===n&&(n=v),!n)throw Error("Invalid configuration, parameter `thoughtspotHost` was not provided and could not be automatically deduced");s(n),d(o),a(n,function(o){return o?(c()&&u(),E=!0,t(!0),void 0):c()?(u(),E=!0,t(!1),void 0):(i(n),void 0)})}function f(){window.parent.postMessage({type:l.THOUGHTSPOT_AUTH_EXPIRED},"*")}var p="5e16222e-ef02-43e9-9fbd-24226bf3ce5b",l={THOUGHTSPOT_AUTH_EXPIRED:"ThoughtspotAuthExpired"},T={AUTH_VERIFICATION:"/callosum/v1/session/info",SSO_LOGIN_TEMPLATE:"/callosum/v1/saml/login?targetURLPath={targetUrl}"},v="",m=[],E=!1;return v=o(),{initialize:h,notifyOnAuthExpiration:f}}();
